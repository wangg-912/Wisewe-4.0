var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,l=Object.getOwnPropertySymbols,a=Object.prototype.propertyIsEnumerable,o=(t,l,a)=>l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[l]=a,s=(e,s)=>{for(var n in s||(s={}))t.call(s,n)&&o(e,n,s[n]);if(l)for(var n of l(s))a.call(s,n)&&o(e,n,s[n]);return e};import{z as n,l as c,G as r,H as i,b as u,u as f,e as p}from"./index.cb67af22.js";import{r as d}from"./animation.016df083.js";import{a as h,u as g,d as v,n as m,f as T,j as C,k,U as w,C as y,t as x,y as S,z as b,l as L,V as $,r as P,c as _,M as A,w as O,E as j,B as R,L as W,Z as Q,a0 as E,A as I,X as M,a1 as q}from"./element-plus.34e177e2.js";function B({el:e,position:t="scrollLeft",to:l,duration:a=500,callback:o}){const s=h(!1),r=e[t],i=l-r;let u=0;a=n(a)?500:a;const f=function(){if(!g(s))return;u+=20;const l=(n=u,p=r,h=i,(n/=a/2)<1?h/2*n*n+p:-h/2*(--n*(n-2)-1)+p);var n,p,h;((e,t,l)=>{e[t]=l})(e,t,l),u<a&&g(s)?d(f):o&&c(o)&&o()};return{start:()=>{s.value=!0,f()},stop:()=>{s.value=!1}}}var z=v({name:"ScrollPane",setup(){const e=h(null);return{handleScroll:function(t){const l=t.wheelDelta||40*-t.deltaY,a=g(e).wrap;a.scrollLeft=a.scrollLeft+l/4},scrollContainer:e,moveToTarget:function(t){const l=g(e).$el.offsetWidth,a=g(e).wrap,o=g(e).$parent.$parent.tagRefs;let s=null,n=null;if(o.length>0&&(s=o[0],n=o[o.length-1]),s===t)a.scrollLeft=0;else if(n===t)a.scrollLeft=a.scrollWidth-l;else{const e=o.findIndex((e=>e===t)),s=o[e-1],n=o[e+1],c=n.$el.offsetLeft+n.$el.offsetWidth+4,r=s.$el.offsetLeft-4;c>a.scrollLeft+l?m((()=>{const{start:e}=B({el:a,position:"scrollLeft",to:c-l,duration:500});e()})):r<a.scrollLeft&&m((()=>{const{start:e}=B({el:a,position:"scrollLeft",to:r,duration:500});e()}))}},moveTo:function(t){const l=g(e).wrap;m((()=>{const{start:e}=B({el:l,position:"scrollLeft",to:l.scrollLeft+t,duration:500});e()}))}}}});const H=y(),V=H(((e,t,l,a,o,s)=>{const n=T("el-scrollbar");return C(),k(n,{ref:"scrollContainer",class:"scroll-container",onWheel:e.handleScroll},{default:H((()=>[w(e.$slots,"default",{},void 0,!0)])),_:3},8,["onWheel"])}));function X(){const e=h([]);let t=!1;return t||(!function(){const t=function(e){const t=[];return e&&e.forEach((e=>{e.meta&&e.meta.affix&&t.push(x(e))})),t}(r.getRoutes());e.value=t;for(const e of t)i.addTagAction({meta:e.meta,name:e.name,path:e.path})}(),t=!0),e.value.map((e=>{var t;return null==(t=e.meta)?void 0:t.title})).filter(Boolean)}z.render=V,z.__scopeId="data-v-dc40206c";var Y=v({name:"QuickPicker",emits:["move"],setup(e,{emit:t}){const{prefixCls:l}=u("quick-menu"),{currentRoute:a,push:o,replace:s}=f();function n(e){const t=e.slice(-1)[0];o(t?t.path:"/")}return{prefixCls:l,refreshTag:async function(){await i.deleteCacheTag();const{path:e}=a.value;m((()=>{s({path:"/redirect"+e})}))},closeTag:async function(){n((await i.deleteTag(a.value)).tagsState)},closeOtherTags:async function(){const{path:e}=a.value;o(e),i.deleteOtherTags(a.value).then((()=>{t("move")}))},closeAllTags:async function(){n(await i.deleteAllTags())}}}});const D=y();S("data-v-778d5308");const G=L("span",{class:"el-dropdown-link"},[L("i",{class:"el-icon-arrow-down el-icon--right"})],-1),U=$("刷新"),Z=$("关闭"),F=$("关闭其他"),J=$("关闭全部");b();const K=D(((e,t,l,a,o,s)=>{const n=T("el-dropdown-item"),c=T("el-dropdown-menu"),r=T("el-dropdown");return C(),k("div",{class:`${e.prefixCls}`},[L(r,{trigger:"click"},{dropdown:D((()=>[L(c,null,{default:D((()=>[L(n,{icon:"el-icon-refresh-right",class:`${e.prefixCls}--item`,onClick:e.refreshTag},{default:D((()=>[U])),_:1},8,["class","onClick"]),L(n,{icon:"el-icon-close",class:`${e.prefixCls}--item`,onClick:e.closeTag},{default:D((()=>[Z])),_:1},8,["class","onClick"]),L(n,{icon:"el-icon-circle-close",class:`${e.prefixCls}--item`,onClick:e.closeOtherTags},{default:D((()=>[F])),_:1},8,["class","onClick"]),L(n,{icon:"el-icon-error",class:`${e.prefixCls}--item`,onClick:e.closeAllTags},{default:D((()=>[J])),_:1},8,["class","onClick"])])),_:1})])),default:D((()=>[G])),_:1})],2)}));Y.render=K,Y.__scopeId="data-v-778d5308";var N=v({name:"LayoutTags",components:{ScrollPane:z,QuickPicker:Y},setup(){const{currentRoute:e,push:t,replace:l}=f(),a=h(null),o=h(null),n=h(!1),c=h(0),r=h(0),d=h({}),v=h([]);const{prefixCls:T}=u("layout-tags"),{getShowContextmenu:C,getShowQuick:k}=p(),w=P({showScroll:!1});X();const y=_((()=>i.getTagsState.filter((e=>{var t;return!(null==(t=e.meta)?void 0:t.hideTag)}))));function x(t){return e.value.path===t.path}function S(){v.value=[];const t=g(v);m((()=>{for(const l of t)if(l&&l.to.path===e.value.path){g(o).moveToTarget(l),l.to.fullPath!==e.value.fullPath&&i.updateVisitedTags(e.value);break}}))}function b(){const{name:t,meta:l,path:a}=e.value;return t&&i.addTagAction({meta:l,name:l,path:a}),!1}function L(e){const l=e.slice(-1)[0];t(l?l.path:"/")}function $(){n.value=!1}return A((()=>{b()})),O((()=>e.value),(()=>{b(),function(){const{scrollContainer:e}=o.value,{wrap:t}=e;w.showScroll=t.scrollWidth>t.clientWidth}(),S()})),O((()=>n.value),(e=>{e?document.body.addEventListener("click",$):document.body.removeEventListener("click",$)})),s(s({},j(w)),{tagRefs:v,setTagRef:function(e){v.value.push(e)},prefixCls:T,wrapper:a,scrollPane:o,visible:n,top:c,left:r,selectedTag:d,isActive:x,tagClickHandler:function(e){const{path:l}=e;t({path:l}).catch((e=>{}))},move:function(e){g(o).moveTo(e)},moveToCurrentTag:S,getTagsState:y,openMenu:function(e,t){if(!C)return;const{path:l}=e;if("/home"==l)return!1;const o=g(a).getBoundingClientRect().left,s=g(a).offsetWidth-105,i=t.clientX-o+4;r.value=i>s?s:i,c.value=t.offsetY,n.value=!0,d.value=e},closeTag:async function(e){const t=await i.deleteTag(e);x(e)&&L(t.tagsState)},refreshTag:async function(e){await i.deleteCacheTag();const{fullPath:t}=e;m((()=>{l({path:"/redirect"+t})}))},closeOtherTags:async function(){const{path:e}=d.value;t(e),i.deleteOtherTags(d.value).then((()=>{S()}))},closeAllTags:async function(){L(await i.deleteAllTags())},getShowContextmenu:C,getShowQuick:k})}});const ee=y();S("data-v-4a7941d0");const te=L("i",{class:"el-icon-arrow-left"},null,-1),le={class:"scroll-container"},ae=L("i",{class:"el-icon-arrow-right"},null,-1),oe=L("i",{class:"el-icon-refresh-right"},null,-1),se=$("  刷新 "),ne=L("i",{class:"el-icon-close"},null,-1),ce=$("  关闭 "),re=L("i",{class:"el-icon-circle-close"},null,-1),ie=$("  关闭其他 "),ue=L("i",{class:"el-icon-error"},null,-1),fe=$("  关闭全部");b();const pe=ee(((e,t,l,a,o,s)=>{const n=T("router-link"),c=T("scroll-pane"),r=T("QuickPicker"),i=T("el-divider");return C(),k("div",{class:e.prefixCls},[L("div",{class:`${e.prefixCls}-wrapper`,ref:"wrapper"},[e.showScroll?(C(),k("div",{key:0,class:`${e.prefixCls}-wrapper-prev`,onClick:t[1]||(t[1]=t=>e.move(-200))},[te],2)):R("",!0),L(c,{ref:"scrollPane",class:`${e.prefixCls}-wrapper-scroll`},{default:ee((()=>[L("div",le,[(C(!0),k(W,null,Q(e.getTagsState,(t=>(C(),k(n,{class:["tag-item el-tag",e.isActive(t)?"el-tag--dark selected":"el-tag--info"],ref:e.setTagRef,key:t.path,to:{path:t.path,query:t.query,fullPath:t.fullPath},onContextmenu:E((l=>e.openMenu(t,l)),["prevent"])},{default:ee((()=>[L("span",null,I(t.meta.title),1),t&&t.meta&&t.meta.affix?R("",!0):(C(),k("i",{key:0,class:"el-icon-close icon-close",onClick:E((l=>e.closeTag(t)),["prevent","stop"])},null,8,["onClick"]))])),_:2},1032,["class","to","onContextmenu"])))),128))])])),_:1},8,["class"]),e.showScroll?(C(),k("div",{key:1,class:`${e.prefixCls}-wrapper-next`,onClick:t[2]||(t[2]=t=>e.move(200))},[ae],2)):R("",!0),e.getShowQuick?(C(),k(r,{key:2,onMove:e.moveToCurrentTag},null,8,["onMove"])):R("",!0),e.getShowContextmenu?M((C(),k("ul",{key:3,style:{left:e.left+"px",top:e.top+"px"},class:"contextmenu"},[L("li",{onClick:t[3]||(t[3]=t=>e.refreshTag(e.selectedTag))},[oe,se,L(i,{class:"line"})]),e.isActive(e.selectedTag)?R("",!0):(C(),k("li",{key:0,onClick:t[4]||(t[4]=t=>e.closeTag(e.selectedTag))},[ne,ce,L(i,{class:"line"})])),L("li",{onClick:t[5]||(t[5]=(...t)=>e.closeOtherTags&&e.closeOtherTags(...t))},[re,ie,L(i,{class:"line"})]),L("li",{onClick:t[6]||(t[6]=(...t)=>e.closeAllTags&&e.closeAllTags(...t))},[ue,fe])],4)),[[q,e.visible]]):R("",!0)],2)],2)}));N.render=pe,N.__scopeId="data-v-4a7941d0";export default N;
